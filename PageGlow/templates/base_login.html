{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{title}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link type="text/css" href="{% static 'main/css/app.css' %}" rel="stylesheet"/>
    <!-- <link type="text/css" rel="stylesheet" href="{% static 'main/css/avtorizacia.css' %}"> -->
        <script>
        // Устанавливаем тему сразу, до загрузки остального JS
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.documentElement.classList.add('dark-mode');
            document.documentElement.setAttribute('data-bs-theme', 'dark');
        }
    </script>
</head>
<body class="{% block body_class %}{% endblock %}">
<header class="site-header">
    <div class="pg-container header-inner">
        <a class="brand" href="{% url 'home' %}">PageGlow</a>
    </div>
</header>

<main class="page">
    <div class="pg-container">

    <div class="content">
        {% block content %}{% endblock %}
    </div>

    </div>
</main>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const toggleButton = document.getElementById('theme-toggle');
    const body = document.body;
    const htmlElement = document.documentElement;

    // Функция для установки темы
    function setTheme(isDark) {
        if (isDark) {
            body.classList.add('dark-mode');
            htmlElement.setAttribute('data-bs-theme', 'dark');
            if (toggleButton) {
                toggleButton.setAttribute('data-bs-theme', 'dark');
            }
            localStorage.setItem('theme', 'dark');
        } else {
            body.classList.remove('dark-mode');
            htmlElement.removeAttribute('data-bs-theme');
            if (toggleButton) {
                toggleButton.removeAttribute('data-bs-theme');
            }
            localStorage.removeItem('theme');
        }
    }

    // Применяем тему ДО того, как страница станет видимой пользователю
    const savedTheme = localStorage.getItem('theme') === 'dark';
    setTheme(savedTheme);

    // Обработчик клика для переключения темы
    if (toggleButton) {
        toggleButton.addEventListener('click', () => {
            const isCurrentlyDark = body.classList.contains('dark-mode');
            setTheme(!isCurrentlyDark);
        });
    }
});

</script>
</body>
</html>