{% load static %}
{% load glow_tags %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link type="text/css" href="{% static 'main/css/style.css' %}" rel="stylesheet"/>
    <link  type="text/css" href="{% static 'main/css/addpage.css' %}" rel="stylesheet" >
    <link type="text/css" href="{% static 'main/css/categories.css' %}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
<header>
    <ul>
        <h2><a class="logo" href="{% url 'home' %}">PageGlow</a></h2>



        {% for m in mainmenu %}
            <li class="menu-bar">
                <a class="nav-bar" href="{% url m.url_name %}">{{ m.title }}</a>
            </li>
        {% endfor %}
        {% if user.is_authenticated %}

        <div class="user-name">
            <a class="user-profile" href="{% url 'users:profile' %}">{{user.username}}</a>
        </div>
            {% if user.photo %}
            <div class="user-photo">
                <img class="user-img-head" src="{{user.photo.url}}" alt="">
            </div>
            {% else %}
            <div class="user-photo">
                <img class="user-img-head" src="{{default_image}}" alt="">
            </div>
            {% endif %}
        {% else %}
        <li class="login-last last"><a class="nav-bar" href="{% url 'users:login' %}">Войти</a></li>
        {% endif %}
    </ul>
</header>
<main class="container">

    <div class="content">
        {% block content %}{% endblock %}
    </div>
    <div class="wrapper">
        <aside class="sidebar">
        {% show_categories %}
        <li class="tg">{% show_all_tags %}</li>
    </aside>
    </div>

    {% block navigation %}
    {% endblock %}

</main>
<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-logo">
      <h3>PageGlow</h3>
    </div>


    <nav class="footer-nav">
        <p>Ссылки</p>
      <ul>
        <li><a href="/about">О нас</a></li>
        <li><a href="/services">Услуги</a></li>
        <li><a href="/portfolio">Портфолио</a></li>
        <li><a href="/contact">Контакты</a></li>
      </ul>
    </nav>

    <div class="footer-contacts">
      <p>Email: <a href="mailto:info@pageglow.com">pageglow3@gmail.com</a></p>
      <p>Телефон: <a href="tel:+74951234567">+7 (495) 123‑45‑67</a></p>
    </div>

    <div class="footer-social">
      <a href="https://t.me/pageglow">Telegram</a>
      <a href="https://vk.com/pageglow">VK</a>
      <a href="https://github.com/pageglow">GitHub</a>
    </div>

    <div class="footer-copyright">
      <p>&copy; 2026 PageGlow. Все права защищены.</p>
    </div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>


<script>
    const textarea = document.querySelector('textarea[name="content"]');
    const preview = document.getElementById('preview');

    textarea.addEventListener('input', () => {
        preview.innerHTML = marked(textarea.value);
    });
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const input = document.getElementById('id_content');
    const preview = document.getElementById('preview');

    if (!input || !preview) {
        console.error('Элементы не найдены!');
        return;
    }

    function updatePreview() {
        try {
            preview.innerHTML = marked.parse(input.value);
        } catch (e) {
            console.error('Ошибка разметки:', e);
            preview.textContent = 'Ошибка в Markdown-разметке';
        }
    }

    // Обновление при вводе (с дебаунсом)
    let timeout;
    input.addEventListener('input', function() {
        clearTimeout(timeout);
        timeout = setTimeout(updatePreview, 200);
    });

    // Инициализация
    updatePreview();
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const input = document.getElementById('markdown-field');
    const preview = document.getElementById('preview');
    const editorContainer = document.getElementById('editor-container');
    const previewContainer = document.getElementById('preview-container');


    // Кнопки
    const btnEdit = document.getElementById('btn-edit');
    const btnPreview = document.getElementById('btn-preview');
    const btnSplit = document.getElementById('btn-split');

    // Функция обновления предпросмотра
    function updatePreview() {
        try {
            preview.innerHTML = marked.parse(input.value);
        } catch (e) {
            console.error('Ошибка разметки:', e);
            preview.textContent = 'Ошибка в Markdown-разметке';
        }
    }

    // Режимы отображения
    function showEditor() {
        editorContainer.style.display = 'block';
        previewContainer.style.display = 'none';
    }

    function showPreview() {
        editorContainer.style.display = 'none';
        previewContainer.style.display = 'block';
        updatePreview();
    }

    function showSplit() {
        editorContainer.style.display = 'block';
        previewContainer.style.display = 'block';
        updatePreview();
    }

    // Обработчики кнопок
    btnEdit.addEventListener('click', showEditor);
    btnPreview.addEventListener('click', showPreview);
    btnSplit.addEventListener('click', showSplit);

    // Обновление предпросмотра при вводе (только в режимах с предпросмотром)
    input.addEventListener('input', function() {
        if (previewContainer.style.display !== 'none') {
            updatePreview();
        }
    });

    // Инициализация: стартовый режим — «Разделить»
    showSplit();
});


</script>
</body>
</html>